# Project Overview
This project contains configurations, guidelines, and instructions for various AI code agents used in our development workflow.

The project provides a scaffolding structure stored in `/dist` folder that can be imported into other projects to quickly set up AI code agents.

All the prompts and instructions in this project relate to typical Python / machine learning development projects.

## Supported Agent Frameworks
- **GitHub Copilot** - `.github/` folder structure
- **OpenCode AI** - `.opencode/` folder structure  
- **OpenAI Codex** - `.codex/` folder structure
- **Warp.Dev AI** - Compatible with above structures

## Project Structure

### Source Structure (`/src`)
```
/src
  /base                      # Shared content copied to ALL targets
    /skills                  # Reusable skills (no suffix in source)
      /docstring-python
        SKILL.md
        example_docstring.py
    /agents                  # Agent definitions (no suffix in source)
      code-reviewer.md
      debug.md
      high-lvl-plan.md
      jira-assistant.md
    /prompts                 # Prompt templates (no suffix in source)
      code-review-diff.md
      create-unittest-python.md
      write-docstrings.md
    /instructions            # GitHub-specific instructions (no suffix in source)
      python.md
      python-test.md
      commit-instructions.md

  /targets                   # Target-specific content (overrides base)
    /.codex
      /prompts
        test-component.md    # Codex-only prompt
      /skills
        ...                  # Target-specific overrides
    /.opencode
      /agent
        reviewer.md          # OpenCode-specific agent
        debugger.md
      /command
        run_review.md
        run_test.md
      opencode.jsonc
    /.github
      copilot-instructions.md
      install-superpowers.md
    /docs                    # Passthrough to dist/docs/
      AGENTS.md
    /tests                   # Passthrough to dist/tests/
      AGENTS.md
    /.vscode                 # Passthrough to dist/.vscode/
      settings.json
    AGENTS.md                # Passthrough to dist/AGENTS.md

  /templates                 # Jinja2 templates for content reuse
    python_test_core.md      # Referenced via {% include "python_test_core.md" %}
```

### Output Structure (`/dist`)
```
/dist                        # Generated by build.py
  /.github
    /skills                  # From base/skills
    /agents                  # From base/agents (with .agent.md suffix)
    /prompts                 # From base/prompts (with .prompt.md suffix)
    /instructions            # From base/instructions (with .instructions.md suffix)
    copilot-instructions.md
    install-superpowers.md
  
  /.opencode
    /skill                   # From base/skills (singular folder name)
    /agent                   # From base/agents (singular, no suffix)
    /command                 # From base/prompts (mapped folder name, no suffix)
    opencode.jsonc
  
  /.codex
    /skills                  # From base/skills
    /agents                  # From base/agents (no suffix)
    /prompts                 # From base/prompts (no suffix)
  
  /docs                      # From targets/docs
  /tests                     # From targets/tests
  /.vscode                   # From targets/.vscode
  AGENTS.md                  # From targets/AGENTS.md
```

## Build System

### Quick Start
```bash
# Install dependencies
uv sync

# Build all targets
./build.sh
# or: uv run python build.py

# Build specific target
./build.sh --target .github

# Clean and rebuild
./build.sh --clean
```

### How It Works

1. **Base Content Processing**: Files from `src/base/` are copied to all targets with:
   - Folder name mapping (e.g., `prompts` â†’ `command` for OpenCode)
   - File suffix transformation (e.g., `.md` â†’ `.agent.md` for GitHub agents)
   - Jinja2 template resolution for `{% include %}` directives

2. **Target-Specific Overrides**: Files in `src/targets/{target}/` override base files:
   - If both `src/base/prompts/test.md` and `src/targets/.github/prompts/test.prompt.md` exist, the target version wins
   - Target files are already correctly named (no suffix transformation)

3. **Template Resolution**: Any markdown file can include templates:
   ```markdown
   # My Prompt
   
   {% include "python_test_core.md" %}
   
   Additional content...
   ```

### Configuration

The `build_config.yaml` file defines:
- **Folder mappings**: Where base folders map to in each target
- **Suffix rules**: How file extensions are transformed per target
- **Include rules**: Which base folders apply to each target

Example for `.github` target:
```yaml
.github:
  folder_mappings:
    prompts: prompts
  file_suffix_rules:
    prompts: ".prompt.md"    # test.md â†’ test.prompt.md
    agents: ".agent.md"      # debug.md â†’ debug.agent.md
```

### Adding New Content

**To add shared content (appears in all targets):**
1. Create file in `src/base/{folder}/` (without suffix)
2. Run `./build.sh`

**To add target-specific content:**
1. Create file in `src/targets/{target}/` (with correct suffix/name)
2. Run `./build.sh`

**To create reusable templates:**
1. Create file in `src/templates/`
2. Reference with `{% include "filename.md" %}` in any markdown file
3. Run `./build.sh`

**Example: Creating a template and using it**

```bash
# 1. Create a template
cat > src/templates/api_guidelines.md << 'EOF'
## API Design Guidelines

- Use RESTful conventions
- Version your APIs (v1, v2)
- Return consistent error responses
- Document all endpoints
EOF

# 2. Use template in a base prompt
cat > src/base/prompts/design-api.md << 'EOF'
---
description: "Design RESTful API endpoints"
---

# API Design Prompt

{% include "api_guidelines.md" %}

## Additional Requirements
- Include OpenAPI/Swagger documentation
- Implement rate limiting
EOF

# 3. Build to generate distribution
./build.sh

# 4. Verify - template content is now in all targets
cat dist/.github/prompts/design-api.prompt.md
cat dist/.opencode/command/design-api.md
```

ðŸ“– **For detailed template usage, see [TEMPLATE_GUIDE.md](./TEMPLATE_GUIDE.md)**